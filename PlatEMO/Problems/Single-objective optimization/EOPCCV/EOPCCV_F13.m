classdef EOPCCV_F13 < PROBLEM
% <2022> <single> <real/label> <expensive/none>
% Expensive optimization problems with continuous and categorical variables

%------------------------------- Reference --------------------------------
% J. Liu, Y. Wang, G. Sun, and T. Pang. Multisurrogate-assisted ant colony
% optimization for expensive optimization problems with continuous and
% categorical variables. IEEE Transactions on Cybernetics, 2022, 52(11):
% 11348-11361.
%------------------------------- Copyright --------------------------------
% Copyright (c) 2026 BIMK Group. You are free to use the PlatEMO for
% research purposes. All publications which use this platform or any code
% in the platform should acknowledge the use of "PlatEMO" and reference "Ye
% Tian, Ran Cheng, Xingyi Zhang, and Yaochu Jin, PlatEMO: A MATLAB platform
% for evolutionary multi-objective optimization [educational forum], IEEE
% Computational Intelligence Magazine, 2017, 12(4): 73-87".
%--------------------------------------------------------------------------

% This function is written by Jiao Liu (email: jiao.liu@ntu.edu.sg)

    properties
        Dr;     % Number of continuous variables
        Dc;     % Number of categorical variables
        len_c;  % length of values of categorical variables
    end
    methods
        %% Default settings of the problem
        function Setting(obj)
            obj.Dr       = 2;
            obj.Dc       = 8;
            obj.M        = 1;
            obj.D        = obj.Dr + obj.Dc; 
            obj.lower    = [-100*ones(1,obj.Dr),ones(1,obj.Dc)];
            obj.upper    = [100*ones(1,obj.Dr),5*ones(1,obj.Dc)];
            obj.len_c    = 5*ones(1,obj.Dc);
            obj.encoding = [zeros(1,obj.Dr),zeros(1,obj.Dc)+3];
        end
        %% Calculate objective values
        function PopObj = CalObj(obj,PopDec)
            load elliptic_M_D10
            PopDec(:,obj.Dr+1:obj.D) = ceil(PopDec(:,obj.Dr+1:obj.D));
            Shift = [5.38298439575843,0.156040063482806,47.8659207691551,-17.0993590692209,-32.5755765450850,-29.2208147430448,-32.7262447432896,-43.5348733031439,1.91412669230780,-36.7251677524501;8.01882134098408,13.0468682524009,-50.2789473800410,17.6310662601793,27.7491646604578,-14.6371353891586,53.3852630474293,-59.4139848732132,-12.6618403024697,27.8389748104925;-56.0972131002918,-29.7261333619182,-51.4218307816201,-52.2379675756525,-33.1524615207669,31.1215665389870,-56.2405602908706,-49.4245203819207,-3.56777133256551,-53.1349811973377;40.0468441172076,-51.2033137625638,-5.78067002015756,-37.5204797340806,55.2096884425106,-14.0404175508788,51.0570165070199,-9.38898751244138,-18.1507562446547,-21.6578743755631;19.7792918990844,6.15854138370283,59.7289519499903,-50.8625677295510,-38.2367434832599,23.6011491526954,21.1574867416932,-56.9488983848310,-7.88998549194810,-27.2089034510105;-36.8524749575842,0.937213031970209,-16.4921332039407,-18.6013377433914,-34.8928592278812,-27.5997515185125,20.4656281211452,-50.0485681578977,1.79549841901711,-58.0375591202109;32.6679532015438,-39.5497317841428,4.63040792636839,-3.35615157994431,54.6377175610706,50.6178887975812,-28.2398361850544,-53.9073688224430,-45.1022089458766,19.1242812257553;12.3834355210046,-42.9049786929525,-51.4051538878644,-46.1563786280937,-45.0191664948777,26.2418052276801,-13.7041832615035,-58.2566031383419,-14.7915123485373,2.84118420446472;-15.6534531644331,56.5645809571100,-56.5858376608280,23.0040729982985,26.5878654556407,43.5885239141866,-18.0061543965734,17.3949159881065,-47.5094580682017,-17.4511788697976;-38.7876486127720,-1.84958912611182,-1.47675334214593,-24.2365950905047,-53.1159013012313,15.1259254950438,10.0905676868104,-27.1703884917392,-57.2121105387401,-58.3011813947515;12.2028163864149,-58.1749362039230,58.5193401916506,31.9412948682289,11.9013261771361,3.52281008504460,4.50459191148737,-32.2626160176065,33.2864170627752,9.06759381609585;37.6944671539451,-17.3397654064086,0.978888507006765,-20.6913090950260,-52.2650256346191,-0.750904324904028,32.6520715646819,-59.8856106362501,24.8291129472234,-27.1774974708410;-56.9302909806480,-4.32352800980121,-13.2777368641882,-33.2863784288770,2.54960929822160,58.5407552695267,-8.18261015915254,-2.02646271668465,28.3579333160536,52.5268506195709;-28.9333981777614,-36.3920728680405,16.4262995289830,-30.3604952627939,-49.1520445749622,33.5429416773583,-26.6669434161707,17.6184402029257,-6.92580187085142,14.1494581385916;46.4848351492837,8.47342541432953,-41.0387260893254,-42.0693298510627,-19.5203234091343,-32.5740595409061,-31.5576978854182,-46.4516350809891,19.7996872338164,-30.1682941061894;55.6415028469456,-14.9233974518958,-5.89460687113799,-58.2080485674017,-35.8884177679782,-46.4684683169933,32.7121088785471,42.8803316200128,47.0073979880688,-59.1195310970300;-7.53110941339680,-12.2400801955084,19.1376560905308,11.3605548574709,20.8826190961181,-1.51562310930871,44.6424451560056,46.6970268499253,6.01097960685627,-6.37732616639784;-46.4733689071648,-52.8070046939238,-58.4967184230776,-5.19648382279804,52.5279379536310,35.8985680566838,-9.87877835219992,-30.5819391498975,24.4045547383724,-26.9153017572964;32.2860963678017,52.1442168020079,-58.9646711265715,56.0174222379790,-37.7502253207295,-39.8359740951483,33.1393187173408,15.4931538095851,-46.3720198041311,15.7294285516815;-46.8471959377739,-59.1189697768632,43.8696016221592,18.4574393171451,40.8208812696823,-21.0644780681500,58.1731393619470,-48.7190871063803,-20.5777664180633,-7.45817602229874;-20.5638496266320,31.1096870201650,15.6374314117919,-0.309855673852923,38.1799171261632,56.2381799423996,-9.33350660367319,-18.8853864131170,11.5316901416047,-55.2077117658390;44.5207365343195,-39.1663981993206,-11.0903323602648,-17.2063788983512,20.0163920603642,-44.8357985381741,33.5212796156130,0.971833112032819,-53.8067388674294,21.3583323065647;-49.2514418248899,11.2019323488276,15.3969971029705,16.1324362665608,-8.90043364999414,-47.4225264013880,3.29265853953406,20.5183043979341,-36.2789409709992,45.8872214244908;51.9393088253336,-33.0776096100441,33.7393677967311,-1.44530761781002,-38.3526708425598,-23.6621607885602,-47.9542049116168,-31.1608452384623,53.1178449562711,-38.7729020773200;40.6272848321398,3.35221010109294,36.9954185414477,-46.9596545799236,-1.34051182455599,-28.1948273748588,35.6374271399865,-45.5709600730338,-39.3257908439374,12.4527304436349;-44.7573075814502,-49.8609583249282,-27.8591426530789,-9.78328041648197,22.1966185530364,52.7333336231625,-4.07004063410584,-50.6471369472574,-2.97743220203904,-54.4787175341149;54.0641601687202,5.94510541236173,40.8676800456614,-54.1323618613240,-29.7534189698217,41.1381285257373,1.04652140837538,-23.4978719573841,-8.05613985006576,-41.2760277248080;-38.3804084435894,-4.82622453572181,-40.0843063655989,13.4192022806569,-4.42650739540279,-28.2542884199066,-42.9574921409412,-36.4945817701651,-45.3040122789322,-49.3805514149941;-9.15126539090601,-14.9460794705951,-57.9854314316028,-25.8656597585255,-34.7499564497765,-3.97008736516141,-43.8425792906147,17.9732979231220,43.2394552211898,-57.9515005942964;-12.7629281692594,55.8935624197260,2.90304631416869,40.3230228740842,12.1165749882135,5.03224203600122,15.6406837330110,39.0254465038792,16.6369523688438,-43.7177503998963;5.34398178545453,-50.2869102154180,41.9173530087223,22.2369872537653,29.8564179438291,27.9631878386112,-6.98390969340608,-48.5198407871605,-23.7423243865864,40.2011367859359;26.4039684227745,57.8749620704517,-21.5899067624349,-50.4002188917860,-42.1741624671534,-30.9768325765797,-15.5131114235310,-49.8155321965339,46.8598634581227,40.5453448257340;0.411707897384126,-19.2149507473485,6.92069478359923,0.0806791162030009,-41.4988833004268,7.09107568557293,-6.44844442413917,16.8846648904123,9.36076256893809,-8.49830545861609;-21.8669873743991,-21.8100733794959,37.2073505174416,9.32022614526292,44.2658956951937,-26.9710898472489,-7.23631147300139,38.7563984727284,55.9615031997469,31.2074387103366;40.9210055735554,34.7063805837063,-54.9001856545804,16.2371555143397,-44.7892707012800,26.8035895939951,59.5196776744747,-7.23829437085057,38.8450929631915,44.5854218240841;-57.0221866458234,41.3040940154344,-41.7705417461307,12.5005335197217,-0.0577082680002761,23.1548633419848,-6.48854111756375,-56.7461640692231,-35.7199981574270,-13.1877971665220;38.5379605076532,49.4530386325253,-19.6200617718927,-56.9558670553009,-3.92971212439862,-27.8641912232542,-51.6501877606619,9.01213520793658,17.1455252572846,52.8519540010088;16.3048546350395,-39.8431722511408,26.5611017606009,57.5039491407865,-12.6503203046825,2.03452262256057,-0.767880363985782,-8.24476964911762,-36.8257086461259,13.7559300532446;20.0050886915846,-40.3503838030228,-9.27337351770049,-9.01122794970178,-29.0056589303091,46.0696152983637,-1.11107063716908,52.6744555350713,-54.9699317384819,11.1753789731409;15.7561789677453,-19.8224346680012,-12.8592745275718,54.0915550234613,-11.5408925338185,-56.8648834980121,-16.6927043261660,7.20878861510690,44.1426382651340,48.4871159705669;-54.0446907788933,-24.8165794103786,37.2522611657216,2.83675228303763,-25.4842677438659,40.5436546239162,-22.2728004352270,-12.3562610794481,-31.2468483990432,58.0860348440827;-21.6988418704522,-40.6006826317324,-55.5352613694441,-16.0229550290346,-2.16403198582023,33.8247771859965,-44.5406776840153,53.5739736103801,-17.2830200140636,-57.4596165698739;5.72380428401837,23.8351688156040,-10.9932106496565,25.5206845513209,-6.59481697334721,-12.0884736294155,-3.83960573630660,34.0516667851904,50.7907823175125,48.4905829352844;56.1482824324391,50.5293956009088,58.1058584641539,-0.645624703282678,-10.7083571218577,45.4635715719606,44.2504647979895,-56.2308924450124,48.7503004544209,-43.6346191903930;45.2807661011175,18.4516478045490,11.3375717684182,-37.3670021658272,51.7798477887031,27.2336589946714,-56.2504644082919,-15.9898201100688,-4.24483045896557,-17.2996731328503;-34.6087141283345,5.32233616278460,48.9112174289753,59.0252128910654,-57.0153664981336,-51.5587689200756,21.1328781698569,-58.7703543104745,-10.5626159408097,-9.06189187617250;-2.98116528561208,-33.9603184718948,25.1153504962521,-21.8354072227156,-51.1494903849377,46.8756190352421,-44.6596995501404,49.2805087301573,-27.3649895132097,14.1192578230311;11.7793615612297,-31.1803305830539,51.5380976086817,-32.4184327573439,-8.29821228712755,-39.7170000132737,-3.10792713632102,9.89827148026772,16.0827316622517,-34.6351350290503;32.0252216396003,47.8159293382772,3.11562911919859,2.79425459693737,-33.0685643833198,46.3032823910658,-57.5013170124463,-25.1291830342733,-58.6174829777294,-45.3385854626875;-12.9958249208388,-55.1471181842954,15.5305423361628,-17.5753531063433,-56.6348828457251,57.7287647914426,-24.4682549185522,-48.7452109586462,14.7547151549073,-41.9481403166121];
            z(:,1:obj.Dr) = PopDec(:,1:obj.Dr);
            for i = 1 : obj.Dc
                v = Shift(:,obj.Dr+i);
                z(:,obj.Dr+i) = v(PopDec(:,obj.Dr+i));
            end
            
            z = (z - Shift(1,:))*M/3;
            PopObj = 20 + exp(1) -20*exp(-0.2*sqrt((1/obj.D).*sum(z.^2,2))) -exp((1/obj.D).*sum(cos(2*pi*z),2));
        end
    end
end